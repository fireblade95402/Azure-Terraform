{
  "version": 4,
  "terraform_version": "0.12.20",
  "serial": 27,
  "lineage": "7bb7e25d-c79e-4208-64b0-2c0dc7b4f09d",
  "outputs": {
    "front-door-object": {
      "value": {
        "backend_pool": [
          {
            "backend": [
              {
                "address": "www.bing.com",
                "enabled": true,
                "host_header": "www.bing.com",
                "http_port": 80,
                "https_port": 443,
                "priority": 1,
                "weight": 50
              },
              {
                "address": "www.bing.co.uk",
                "enabled": true,
                "host_header": "www.bing.co.uk",
                "http_port": 80,
                "https_port": 443,
                "priority": 1,
                "weight": 50
              }
            ],
            "health_probe_name": "exampleHealthProbeSetting1",
            "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/Frontdoors/caftest-afd-mwg/BackendPools/exampleBackendBing1",
            "load_balancing_name": "exampleLoadBalancingSettings1",
            "name": "exampleBackendBing1"
          }
        ],
        "backend_pool_health_probe": [
          {
            "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/Frontdoors/caftest-afd-mwg/HealthProbeSettings/exampleHealthProbeSetting1",
            "interval_in_seconds": 120,
            "name": "exampleHealthProbeSetting1",
            "path": "/",
            "protocol": "Http"
          }
        ],
        "backend_pool_load_balancing": [
          {
            "additional_latency_milliseconds": 0,
            "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/Frontdoors/caftest-afd-mwg/LoadBalancingSettings/exampleLoadBalancingSettings1",
            "name": "exampleLoadBalancingSettings1",
            "sample_size": 4,
            "successful_samples_required": 2
          }
        ],
        "cname": "caftest-afd-mwg.azurefd.net",
        "enforce_backend_pools_certificate_name_check": false,
        "friendly_name": "CAF Test for Azure Front Door",
        "frontend_endpoint": [
          {
            "custom_https_configuration": [],
            "custom_https_provisioning_enabled": false,
            "host_name": "caftest-afd-mwg.azurefd.net",
            "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/frontdoors/caftest-afd-mwg/frontendendpoints/exampleFrontendEndpoint1",
            "name": "exampleFrontendEndpoint1",
            "session_affinity_enabled": false,
            "session_affinity_ttl_seconds": 0,
            "web_application_firewall_policy_link_id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/frontdoorwebapplicationfirewallpolicies/caftestwafpolicy"
          }
        ],
        "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/frontdoors/caftest-afd-mwg",
        "load_balancer_enabled": true,
        "location": "global",
        "name": "caftest-afd-mwg",
        "resource_group_name": "test-caf-afd",
        "routing_rule": [
          {
            "accepted_protocols": [
              "Http",
              "Https"
            ],
            "enabled": true,
            "forwarding_configuration": [
              {
                "backend_pool_name": "exampleBackendBing1",
                "cache_enabled": false,
                "cache_query_parameter_strip_directive": "StripNone",
                "cache_use_dynamic_compression": false,
                "custom_forwarding_path": "",
                "forwarding_protocol": "MatchRequest"
              }
            ],
            "frontend_endpoints": [
              "exampleFrontendEndpoint1"
            ],
            "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/Frontdoors/caftest-afd-mwg/RoutingRules/exampleRoutingRule1",
            "name": "exampleRoutingRule1",
            "patterns_to_match": [
              "/*"
            ],
            "redirect_configuration": []
          }
        ],
        "tags": {
          "environment": "DEV",
          "owner": "CAF"
        }
      },
      "type": [
        "object",
        {
          "backend_pool": [
            "list",
            [
              "object",
              {
                "backend": [
                  "list",
                  [
                    "object",
                    {
                      "address": "string",
                      "enabled": "bool",
                      "host_header": "string",
                      "http_port": "number",
                      "https_port": "number",
                      "priority": "number",
                      "weight": "number"
                    }
                  ]
                ],
                "health_probe_name": "string",
                "id": "string",
                "load_balancing_name": "string",
                "name": "string"
              }
            ]
          ],
          "backend_pool_health_probe": [
            "list",
            [
              "object",
              {
                "id": "string",
                "interval_in_seconds": "number",
                "name": "string",
                "path": "string",
                "protocol": "string"
              }
            ]
          ],
          "backend_pool_load_balancing": [
            "list",
            [
              "object",
              {
                "additional_latency_milliseconds": "number",
                "id": "string",
                "name": "string",
                "sample_size": "number",
                "successful_samples_required": "number"
              }
            ]
          ],
          "cname": "string",
          "enforce_backend_pools_certificate_name_check": "bool",
          "friendly_name": "string",
          "frontend_endpoint": [
            "list",
            [
              "object",
              {
                "custom_https_configuration": [
                  "list",
                  [
                    "object",
                    {
                      "azure_key_vault_certificate_secret_name": "string",
                      "azure_key_vault_certificate_secret_version": "string",
                      "azure_key_vault_certificate_vault_id": "string",
                      "certificate_source": "string",
                      "minimum_tls_version": "string",
                      "provisioning_state": "string",
                      "provisioning_substate": "string"
                    }
                  ]
                ],
                "custom_https_provisioning_enabled": "bool",
                "host_name": "string",
                "id": "string",
                "name": "string",
                "session_affinity_enabled": "bool",
                "session_affinity_ttl_seconds": "number",
                "web_application_firewall_policy_link_id": "string"
              }
            ]
          ],
          "id": "string",
          "load_balancer_enabled": "bool",
          "location": "string",
          "name": "string",
          "resource_group_name": "string",
          "routing_rule": [
            "list",
            [
              "object",
              {
                "accepted_protocols": [
                  "list",
                  "string"
                ],
                "enabled": "bool",
                "forwarding_configuration": [
                  "list",
                  [
                    "object",
                    {
                      "backend_pool_name": "string",
                      "cache_enabled": "bool",
                      "cache_query_parameter_strip_directive": "string",
                      "cache_use_dynamic_compression": "bool",
                      "custom_forwarding_path": "string",
                      "forwarding_protocol": "string"
                    }
                  ]
                ],
                "frontend_endpoints": [
                  "list",
                  "string"
                ],
                "id": "string",
                "name": "string",
                "patterns_to_match": [
                  "list",
                  "string"
                ],
                "redirect_configuration": [
                  "list",
                  [
                    "object",
                    {
                      "custom_fragment": "string",
                      "custom_host": "string",
                      "custom_path": "string",
                      "custom_query_string": "string",
                      "redirect_protocol": "string",
                      "redirect_type": "string"
                    }
                  ]
                ]
              }
            ]
          ],
          "tags": [
            "map",
            "string"
          ]
        }
      ]
    },
    "front-door-waf-object": {
      "value": {
        "waf1": {
          "custom_block_response_body": "PGh0bWw+CjxoZWFkZXI+PHRpdGxlPkhlbGxvPC90aXRsZT48L2hlYWRlcj4KPGJvZHk+CkhlbGxvIHdvcmxkCjwvYm9keT4KPC9odG1sPg==",
          "custom_block_response_status_code": 403,
          "custom_rule": [
            {
              "action": "Block",
              "enabled": true,
              "match_condition": [
                {
                  "match_values": [
                    "windows"
                  ],
                  "match_variable": "RequestHeader",
                  "negation_condition": false,
                  "operator": "Contains",
                  "selector": "UserAgent",
                  "transforms": [
                    "Lowercase",
                    "Trim"
                  ]
                }
              ],
              "name": "Rule1",
              "priority": 1,
              "rate_limit_duration_in_minutes": 1,
              "rate_limit_threshold": 10,
              "type": "MatchRule"
            }
          ],
          "enabled": true,
          "frontend_endpoint_ids": [],
          "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/frontdoorwebapplicationfirewallpolicies/caftestwafpolicy",
          "location": "global",
          "managed_rule": [
            {
              "exclusion": [
                {
                  "match_variable": "QueryStringArgNames",
                  "operator": "Equals",
                  "selector": "not_suspicious"
                }
              ],
              "override": [
                {
                  "exclusion": [
                    {
                      "match_variable": "QueryStringArgNames",
                      "operator": "Equals",
                      "selector": "not_suspicious"
                    }
                  ],
                  "rule": [
                    {
                      "action": "Block",
                      "enabled": false,
                      "exclusion": [
                        {
                          "match_variable": "QueryStringArgNames",
                          "operator": "Equals",
                          "selector": "not_suspicious"
                        }
                      ],
                      "rule_id": "933100"
                    }
                  ],
                  "rule_group_name": "PHP"
                }
              ],
              "type": "DefaultRuleSet",
              "version": "1.0"
            }
          ],
          "mode": "Prevention",
          "name": "caftestwafpolicy",
          "redirect_url": "https://www.bing.com",
          "resource_group_name": "test-caf-afd",
          "tags": {
            "environment": "DEV",
            "owner": "CAF"
          }
        }
      },
      "type": [
        "object",
        {
          "waf1": [
            "object",
            {
              "custom_block_response_body": "string",
              "custom_block_response_status_code": "number",
              "custom_rule": [
                "list",
                [
                  "object",
                  {
                    "action": "string",
                    "enabled": "bool",
                    "match_condition": [
                      "list",
                      [
                        "object",
                        {
                          "match_values": [
                            "list",
                            "string"
                          ],
                          "match_variable": "string",
                          "negation_condition": "bool",
                          "operator": "string",
                          "selector": "string",
                          "transforms": [
                            "list",
                            "string"
                          ]
                        }
                      ]
                    ],
                    "name": "string",
                    "priority": "number",
                    "rate_limit_duration_in_minutes": "number",
                    "rate_limit_threshold": "number",
                    "type": "string"
                  }
                ]
              ],
              "enabled": "bool",
              "frontend_endpoint_ids": [
                "list",
                "string"
              ],
              "id": "string",
              "location": "string",
              "managed_rule": [
                "list",
                [
                  "object",
                  {
                    "exclusion": [
                      "list",
                      [
                        "object",
                        {
                          "match_variable": "string",
                          "operator": "string",
                          "selector": "string"
                        }
                      ]
                    ],
                    "override": [
                      "list",
                      [
                        "object",
                        {
                          "exclusion": [
                            "list",
                            [
                              "object",
                              {
                                "match_variable": "string",
                                "operator": "string",
                                "selector": "string"
                              }
                            ]
                          ],
                          "rule": [
                            "list",
                            [
                              "object",
                              {
                                "action": "string",
                                "enabled": "bool",
                                "exclusion": [
                                  "list",
                                  [
                                    "object",
                                    {
                                      "match_variable": "string",
                                      "operator": "string",
                                      "selector": "string"
                                    }
                                  ]
                                ],
                                "rule_id": "string"
                              }
                            ]
                          ],
                          "rule_group_name": "string"
                        }
                      ]
                    ],
                    "type": "string",
                    "version": "string"
                  }
                ]
              ],
              "mode": "string",
              "name": "string",
              "redirect_url": "string",
              "resource_group_name": "string",
              "tags": [
                "map",
                "string"
              ]
            }
          ]
        }
      ]
    }
  },
  "resources": [
    {
      "module": "module.front-door",
      "mode": "managed",
      "type": "azurerm_frontdoor",
      "name": "front-door",
      "provider": "provider.azurerm",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "backend_pool": [
              {
                "backend": [
                  {
                    "address": "www.bing.com",
                    "enabled": true,
                    "host_header": "www.bing.com",
                    "http_port": 80,
                    "https_port": 443,
                    "priority": 1,
                    "weight": 50
                  },
                  {
                    "address": "www.bing.co.uk",
                    "enabled": true,
                    "host_header": "www.bing.co.uk",
                    "http_port": 80,
                    "https_port": 443,
                    "priority": 1,
                    "weight": 50
                  }
                ],
                "health_probe_name": "exampleHealthProbeSetting1",
                "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/Frontdoors/caftest-afd-mwg/BackendPools/exampleBackendBing1",
                "load_balancing_name": "exampleLoadBalancingSettings1",
                "name": "exampleBackendBing1"
              }
            ],
            "backend_pool_health_probe": [
              {
                "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/Frontdoors/caftest-afd-mwg/HealthProbeSettings/exampleHealthProbeSetting1",
                "interval_in_seconds": 120,
                "name": "exampleHealthProbeSetting1",
                "path": "/",
                "protocol": "Http"
              }
            ],
            "backend_pool_load_balancing": [
              {
                "additional_latency_milliseconds": 0,
                "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/Frontdoors/caftest-afd-mwg/LoadBalancingSettings/exampleLoadBalancingSettings1",
                "name": "exampleLoadBalancingSettings1",
                "sample_size": 4,
                "successful_samples_required": 2
              }
            ],
            "cname": "caftest-afd-mwg.azurefd.net",
            "enforce_backend_pools_certificate_name_check": false,
            "friendly_name": "CAF Test for Azure Front Door",
            "frontend_endpoint": [
              {
                "custom_https_configuration": [],
                "custom_https_provisioning_enabled": false,
                "host_name": "caftest-afd-mwg.azurefd.net",
                "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/frontdoors/caftest-afd-mwg/frontendendpoints/exampleFrontendEndpoint1",
                "name": "exampleFrontendEndpoint1",
                "session_affinity_enabled": false,
                "session_affinity_ttl_seconds": 0,
                "web_application_firewall_policy_link_id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/frontdoorwebapplicationfirewallpolicies/caftestwafpolicy"
              }
            ],
            "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/frontdoors/caftest-afd-mwg",
            "load_balancer_enabled": true,
            "location": "global",
            "name": "caftest-afd-mwg",
            "resource_group_name": "test-caf-afd",
            "routing_rule": [
              {
                "accepted_protocols": [
                  "Http",
                  "Https"
                ],
                "enabled": true,
                "forwarding_configuration": [
                  {
                    "backend_pool_name": "exampleBackendBing1",
                    "cache_enabled": false,
                    "cache_query_parameter_strip_directive": "StripNone",
                    "cache_use_dynamic_compression": false,
                    "custom_forwarding_path": "",
                    "forwarding_protocol": "MatchRequest"
                  }
                ],
                "frontend_endpoints": [
                  "exampleFrontendEndpoint1"
                ],
                "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/Frontdoors/caftest-afd-mwg/RoutingRules/exampleRoutingRule1",
                "name": "exampleRoutingRule1",
                "patterns_to_match": [
                  "/*"
                ],
                "redirect_configuration": []
              }
            ],
            "tags": {
              "environment": "DEV",
              "owner": "CAF"
            }
          },
          "private": "bnVsbA==",
          "dependencies": [
            "module.front-door.module.azure_front_door_waf.azurerm_frontdoor_firewall_policy.front-door-waf-policy",
            "module.rg_caftest.azurerm_resource_group.rg"
          ]
        }
      ]
    },
    {
      "module": "module.front-door.module.azure_front_door_waf",
      "mode": "managed",
      "type": "azurerm_frontdoor_firewall_policy",
      "name": "front-door-waf-policy",
      "each": "map",
      "provider": "provider.azurerm",
      "instances": [
        {
          "index_key": "waf1",
          "schema_version": 0,
          "attributes": {
            "custom_block_response_body": "PGh0bWw+CjxoZWFkZXI+PHRpdGxlPkhlbGxvPC90aXRsZT48L2hlYWRlcj4KPGJvZHk+CkhlbGxvIHdvcmxkCjwvYm9keT4KPC9odG1sPg==",
            "custom_block_response_status_code": 403,
            "custom_rule": [
              {
                "action": "Block",
                "enabled": true,
                "match_condition": [
                  {
                    "match_values": [
                      "windows"
                    ],
                    "match_variable": "RequestHeader",
                    "negation_condition": false,
                    "operator": "Contains",
                    "selector": "UserAgent",
                    "transforms": [
                      "Lowercase",
                      "Trim"
                    ]
                  }
                ],
                "name": "Rule1",
                "priority": 1,
                "rate_limit_duration_in_minutes": 1,
                "rate_limit_threshold": 10,
                "type": "MatchRule"
              }
            ],
            "enabled": true,
            "frontend_endpoint_ids": [],
            "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourcegroups/test-caf-afd/providers/Microsoft.Network/frontdoorwebapplicationfirewallpolicies/caftestwafpolicy",
            "location": "global",
            "managed_rule": [
              {
                "exclusion": [
                  {
                    "match_variable": "QueryStringArgNames",
                    "operator": "Equals",
                    "selector": "not_suspicious"
                  }
                ],
                "override": [
                  {
                    "exclusion": [
                      {
                        "match_variable": "QueryStringArgNames",
                        "operator": "Equals",
                        "selector": "not_suspicious"
                      }
                    ],
                    "rule": [
                      {
                        "action": "Block",
                        "enabled": false,
                        "exclusion": [
                          {
                            "match_variable": "QueryStringArgNames",
                            "operator": "Equals",
                            "selector": "not_suspicious"
                          }
                        ],
                        "rule_id": "933100"
                      }
                    ],
                    "rule_group_name": "PHP"
                  }
                ],
                "type": "DefaultRuleSet",
                "version": "1.0"
              }
            ],
            "mode": "Prevention",
            "name": "caftestwafpolicy",
            "redirect_url": "https://www.bing.com",
            "resource_group_name": "test-caf-afd",
            "tags": {
              "environment": "DEV",
              "owner": "CAF"
            }
          },
          "private": "bnVsbA==",
          "dependencies": [
            "module.rg_caftest.azurerm_resource_group.rg"
          ]
        }
      ]
    },
    {
      "module": "module.rg_caftest",
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "rg",
      "each": "map",
      "provider": "provider.azurerm",
      "instances": [
        {
          "index_key": "test",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/461377a7-433d-4980-9506-c35defb10a49/resourceGroups/test-caf-afd",
            "location": "uksouth",
            "name": "test-caf-afd",
            "tags": {
              "environment": "DEV",
              "module": "aztfmod-terraform-azurerm-caf-resource-group-e970ba9",
              "owner": "CAF"
            }
          },
          "private": "bnVsbA=="
        }
      ]
    }
  ]
}
